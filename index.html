<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeria Polaroid</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background-image: url('fotos/bg.jpeg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid #333;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            box-shadow: 3px 3px 0 #333;
            transition: all 0.2s;
        }

        .btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 #333;
        }

        .btn.active {
            background: #333;
            color: white;
        }

        /* Modo Galeria */
        .gallery-mode {
            display: none;
            padding: 100px 40px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .gallery-mode.active {
            display: block;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 32px;
            padding: 20px;
        }

        .gallery-grid .polaroid {
            width: 100%;
            height: auto;
            aspect-ratio: 880 / 1056;
        }

        /* Modo Bancada */
        .counter-mode {
            display: none;
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        .counter-mode.active {
            display: block;
        }

        .counter-mode.detail-view .scattered-polaroid {
            pointer-events: none;
        }

        .counter-mode.detail-view .nav-btn,
        .counter-mode.detail-view .counter {
            opacity: 1;
            pointer-events: all;
        }

        .counter-mode:not(.detail-view) .center-polaroid {
            display: none;
        }

        .counter-mode:not(.detail-view) .nav-btn,
        .counter-mode:not(.detail-view) .counter {
            opacity: 0;
            pointer-events: none;
        }

        .counter-mode:not(.detail-view) .scattered-polaroid {
            pointer-events: all;
            opacity: 1;
        }

        .counter-surface {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Polaroid Styling */
        .polaroid {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 8px 24px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            cursor: pointer;
            border-radius: 2px;
            overflow: hidden;
        }

        .polaroid:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.25), 0 12px 32px rgba(0,0,0,0.2);
        }

        .polaroid-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* Polaroids na bancada (scattered) */
        .scattered-polaroid {
            position: absolute;
            width: 220px;
            height: 264px;
            opacity: 1;
            transition: none;
        }

        .scattered-polaroid.animate-position {
            transition: left 0.8s cubic-bezier(0.34, 1.56, 0.64, 1),
                        top 0.8s cubic-bezier(0.34, 1.56, 0.64, 1),
                        transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1),
                        opacity 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .scattered-polaroid.hide-for-detail {
            opacity: 0;
            pointer-events: none;
        }

        /* Polaroid central (grande) */
        .center-polaroid {
            position: relative;
            width: 440px;
            height: 528px;
            z-index: 50;
            animation: slideIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
        }

        .center-polaroid.closing {
            animation: slideOut 0.6s cubic-bezier(0.68, -0.55, 0.265, 1) forwards;
        }

        @keyframes slideOut {
            from {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            to {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Navegação */
        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border: 3px solid #333;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            z-index: 200;
            box-shadow: 3px 3px 0 #333;
            transition: all 0.3s;
            font-weight: bold;
        }

        .nav-btn:hover {
            transform: translateY(-50%) scale(1.1);
        }

        .nav-btn.left {
            left: 40px;
        }

        .nav-btn.right {
            right: 40px;
        }

        /* Contador */
        .counter {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 10px 20px;
            border: 2px solid #333;
            font-weight: bold;
            box-shadow: 3px 3px 0 #333;
            z-index: 200;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .center-polaroid {
                width: 300px;
                height: 360px;
            }
            
            .scattered-polaroid {
                width: 150px;
                height: 180px;
            }

            .nav-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .controls {
                top: 10px;
                right: 10px;
            }

            .btn {
                padding: 8px 16px;
                font-size: 12px;
            }

            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="controls">
        <button class="btn active" id="counterBtn">Bancada</button>
        <button class="btn" id="galleryBtn">Galeria</button>
    </div>

    <!-- Modo Bancada -->
    <div class="counter-mode active" id="counterMode">
        <div class="counter-surface" id="counterSurface"></div>
        <button class="nav-btn left" id="prevBtn">←</button>
        <button class="nav-btn right" id="nextBtn">→</button>
        <div class="counter" id="counter">1 / 1</div>
    </div>

    <!-- Modo Galeria -->
    <div class="gallery-mode" id="galleryMode">
        <div class="gallery-grid" id="galleryGrid"></div>
    </div>

    <script>
        const NUM_PHOTOS = 20; // Ajuste para o número de fotos que você tem
        let currentIndex = -1; // -1 significa nenhuma foto aberta
        let photos = [];
        let photoPositions = []; // Armazenar posições fixas
        let isAnimating = false; // Controle de animação

        // Gerar array de fotos
        for (let i = 1; i <= NUM_PHOTOS; i++) {
            photos.push(`fotos/${i}.jpg`);
        }

        // Gerar posições fixas para cada foto (uma única vez)
        function generatePositions() {
            photoPositions = photos.map((photo, idx) => {
                const angle = (idx / photos.length) * Math.PI * 2 + Math.random() * 0.5;
                const distance = 300 + Math.random() * 250;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                const rotation = -25 + Math.random() * 50;
                
                return { x, y, rotation };
            });
        }

        // Elementos
        const counterMode = document.getElementById('counterMode');
        const galleryMode = document.getElementById('galleryMode');
        const counterSurface = document.getElementById('counterSurface');
        const galleryGrid = document.getElementById('galleryGrid');
        const counterBtn = document.getElementById('counterBtn');
        const galleryBtn = document.getElementById('galleryBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const counter = document.getElementById('counter');

        // Alternar modos
        counterBtn.addEventListener('click', () => {
            counterMode.classList.add('active');
            galleryMode.classList.remove('active');
            counterBtn.classList.add('active');
            galleryBtn.classList.remove('active');
        });

        galleryBtn.addEventListener('click', () => {
            galleryMode.classList.add('active');
            counterMode.classList.remove('active');
            galleryBtn.classList.add('active');
            counterBtn.classList.remove('active');
        });

        // Criar galeria
        function createGallery() {
            galleryGrid.innerHTML = '';
            photos.forEach((photo, idx) => {
                const polaroid = document.createElement('div');
                polaroid.className = 'polaroid';
                polaroid.innerHTML = `<img src="${photo}" alt="Foto ${idx + 1}" class="polaroid-img">`;
                polaroid.addEventListener('click', () => {
                    currentIndex = idx;
                    updateCounter();
                    counterBtn.click();
                });
                galleryGrid.appendChild(polaroid);
            });
        }

        // Criar visualização de bancada
        function createCounterView() {
            counterSurface.innerHTML = '';
            
            const isDetailView = currentIndex !== -1;
            
            if (isDetailView) {
                counterMode.classList.add('detail-view');
            } else {
                counterMode.classList.remove('detail-view');
            }

            // Criar polaroid central (apenas se estiver em detail view)
            if (isDetailView) {
                const centerPolaroid = document.createElement('div');
                centerPolaroid.className = 'polaroid center-polaroid';
                centerPolaroid.innerHTML = `<img src="${photos[currentIndex]}" alt="Foto central" class="polaroid-img">`;
                centerPolaroid.dataset.index = currentIndex;
                centerPolaroid.addEventListener('click', closeDetail);
                counterSurface.appendChild(centerPolaroid);
            }

            // Criar todos os polaroids espalhados
            photos.forEach((photo, idx) => {
                if (isDetailView && idx === currentIndex) return;

                const polaroid = document.createElement('div');
                polaroid.className = 'polaroid scattered-polaroid';
                polaroid.innerHTML = `<img src="${photo}" alt="Foto ${idx + 1}" class="polaroid-img">`;
                polaroid.dataset.index = idx;
                
                const pos = photoPositions[idx];
                polaroid.style.left = `calc(50% + ${pos.x}px)`;
                polaroid.style.top = `calc(50% + ${pos.y}px)`;
                polaroid.style.setProperty('--rotation', `${pos.rotation}deg`);
                polaroid.style.transform = `translate(-50%, -50%) rotate(${pos.rotation}deg)`;
                polaroid.style.zIndex = Math.floor(Math.random() * 10);

                polaroid.addEventListener('click', () => {
                    if (!isDetailView) {
                        openDetail(idx);
                    }
                });

                counterSurface.appendChild(polaroid);
            });
        }

        // Abrir detalhe da foto
        function openDetail(idx) {
            if (isAnimating) return;
            isAnimating = true;

            currentIndex = idx;
            
            // Esconder a carta que vai para o centro da bagunça
            const scatteredCard = document.querySelector(`.scattered-polaroid[data-index="${idx}"]`);
            if (scatteredCard) {
                scatteredCard.classList.add('hide-for-detail');
            }

            // Criar carta central
            const centerCard = document.createElement('div');
            centerCard.className = 'polaroid center-polaroid';
            centerCard.innerHTML = `<img src="${photos[idx]}" alt="Foto central" class="polaroid-img">`;
            centerCard.dataset.index = idx;
            centerCard.addEventListener('click', closeDetail);
            counterSurface.appendChild(centerCard);

            // Ativar modo detalhe e animar entrada
            setTimeout(() => {
                counterMode.classList.add('detail-view');
                centerCard.classList.add('visible');
                updateCounter();
            }, 50);

            setTimeout(() => {
                isAnimating = false;
            }, 650);
        }

        // Fechar detalhe
        function closeDetail() {
            if (isAnimating || currentIndex === -1) return;
            isAnimating = true;

            const centerCard = document.querySelector('.center-polaroid');
            const oldIndex = currentIndex;

            // Animar saída da carta central
            centerCard.classList.remove('visible');
            centerCard.classList.add('closing');

            setTimeout(() => {
                // Remover carta central
                centerCard.remove();
                
                // Mostrar carta de volta na bagunça
                const scatteredCard = document.querySelector(`.scattered-polaroid[data-index="${oldIndex}"]`);
                if (scatteredCard) {
                    scatteredCard.classList.remove('hide-for-detail');
                }

                // Desativar modo detalhe
                counterMode.classList.remove('detail-view');
                currentIndex = -1;
                updateCounter();

                setTimeout(() => {
                    isAnimating = false;
                }, 50);
            }, 600);
        }

        // Função para trocar foto (apenas quando já está aberto)
        function changePhoto(newIndex) {
            if (isAnimating || currentIndex === -1 || newIndex === currentIndex) return;
            isAnimating = true;

            const oldIndex = currentIndex;
            const centerCard = document.querySelector('.center-polaroid');

            // FASE 1: Fechar carta atual
            centerCard.classList.remove('visible');
            centerCard.classList.add('closing');

            setTimeout(() => {
                // Remover carta central antiga
                centerCard.remove();
                
                // Mostrar carta antiga de volta na bagunça
                const oldScatteredCard = document.querySelector(`.scattered-polaroid[data-index="${oldIndex}"]`);
                if (oldScatteredCard) {
                    oldScatteredCard.classList.remove('hide-for-detail');
                }

                // FASE 2: Abrir nova carta
                setTimeout(() => {
                    currentIndex = newIndex;

                    // Esconder nova carta da bagunça
                    const newScatteredCard = document.querySelector(`.scattered-polaroid[data-index="${newIndex}"]`);
                    if (newScatteredCard) {
                        newScatteredCard.classList.add('hide-for-detail');
                    }

                    // Criar nova carta central
                    const newCenterCard = document.createElement('div');
                    newCenterCard.className = 'polaroid center-polaroid';
                    newCenterCard.innerHTML = `<img src="${photos[newIndex]}" alt="Foto central" class="polaroid-img">`;
                    newCenterCard.dataset.index = newIndex;
                    newCenterCard.addEventListener('click', closeDetail);
                    counterSurface.appendChild(newCenterCard);

                    setTimeout(() => {
                        newCenterCard.classList.add('visible');
                        updateCounter();
                    }, 50);

                    setTimeout(() => {
                        isAnimating = false;
                    }, 650);
                }, 100);
            }, 600);
        }

        // Atualizar contador e vista
        function updateCounter() {
            if (currentIndex === -1) {
                counter.textContent = `Selecione uma foto`;
            } else {
                counter.textContent = `${currentIndex + 1} / ${photos.length}`;
            }
            createCounterView();
        }

        // Navegação
        prevBtn.addEventListener('click', () => {
            if (currentIndex === -1) return;
            const newIndex = (currentIndex - 1 + photos.length) % photos.length;
            changePhoto(newIndex);
        });

        nextBtn.addEventListener('click', () => {
            if (currentIndex === -1) return;
            const newIndex = (currentIndex + 1) % photos.length;
            changePhoto(newIndex);
        });

        // Teclado
        document.addEventListener('keydown', (e) => {
            if (counterMode.classList.contains('active')) {
                if (e.key === 'ArrowLeft') prevBtn.click();
                if (e.key === 'ArrowRight') nextBtn.click();
            }
        });

        // Inicializar
        generatePositions(); // Gerar posições fixas uma única vez
        createGallery();
        updateCounter();
    </script>
</body>
</html>